"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var digitalData={};var DataLayer=function(){function DataLayer(){var isPrivatePage=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;_classCallCheck(this,DataLayer);var _dataLegacy=JSON.parse(typeof data_from_legacy!=="undefined"&&data_from_legacy!==""?data_from_legacy:'{"tagging":""}');var _staticData={versionDL:"20190718_4.0",pageInstanceID:_dataLegacy.tagging.environment?_dataLegacy.tagging.environment.substring(0,2).indexOf("pr")==0?"pro":_dataLegacy.tagging.environment.substring(0,2):"ND",pageSegment:"personas",version:"1.0",channel:"online",language:window.navigator.language.substring(0,2).toUpperCase(),area:isPrivatePage?"privada":"publica",server:window.location.hostname,businessUnit:"BBVA Colombia",userState:isPrivatePage?"logado":"nologado",userAgent:navigator.userAgent,projectName:"",siteAppName:"BBVA Colombia",segmentProfile:""};this._digitalData={versionDL:_staticData.versionDL,pageInstanceID:_staticData.pageInstanceID,page:{pageInfo:{pageName:"",pageIntent:"",pageSegment:_staticData.pageSegment,sysEnv:this._getSysEnv(),version:_staticData.version,channel:_staticData.channel,language:_staticData.language,geoRegion:"",level1:"",level2:"",level3:"",level4:"",level5:"",level6:"",level7:"",level8:"",level9:"",level10:"",area:_staticData.area,server:_staticData.server,businessUnit:_staticData.businessUnit,siteAppName:_staticData.siteAppName,projectName:_staticData.projectName,errorPage:""},pageActivity:{search:{onSiteSearchResults:"",onSiteSearchTerm:"",onSiteSearchEnterTerm:""},link:{name:"",url:"",ext:"",aux1:"",aux2:"",aux3:""},video:{nameOfVideoDisplayed:""},audio:{nameOfPodcastDisplayed:""},loginType:""}},optimization:{attributes:[],event:{eventName:"",optimizationEvent:""}},internalCampaign:{attributes:[],event:{eventInfo:{eventName:"",siteActionName:""}}},user:{device:{userAgent:_staticData.userAgent,mobile:this._getMobile(),root:""},userState:_staticData.userState,profileID:_dataLegacy.tagging.profileID,userID:"",prospectID:"",segment:{global:this._getSegmentGlobal(_dataLegacy.tagging.segmentProfile),profile:_staticData.segmentProfile},gender:this._getGender(_dataLegacy.tagging.gender),country:_dataLegacy.tagging.country,state:_dataLegacy.tagging.state,age:this._getAge(_dataLegacy.tagging.age),civilStatus:"",educationLevel:"",jobType:""},application:{transactionID:"",application:{type:"",name:""},fulfillmentModel:"",typology:"",programTypeHired:"",offer:"",operationNumber:"",process:"",step:"",interactionLevel:"",isQualifiedVisits:"",state:"",errorType:"",earnings:"",expenses:"",customFields:"",globalApplication:""},products:{attributes:[],productPortfolio:[]}};this._verifyLib()}_createClass(DataLayer,[{key:"_verifyLib",value:function _verifyLib(){if(typeof window.digitalView!=="function"){window.digitalView=function(e,t){}}if(typeof window.digitalLink!=="function"){window.digitalLink=function(e,t){}}}},{key:"_getSysEnv",value:function _getSysEnv(){if(WURFL.form_factor==="Tablet"){return"web-movil"}else if(WURFL.form_factor==="Desktop"){return"escritorio"}else if(WURFL.form_factor==="Smartphone"||WURFL.form_factor==="Feature Phone"||WURFL.form_factor==="Other Mobile"){return"app"}}},{key:"_getMobile",value:function _getMobile(){var check=false;(function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))check=true})(navigator.userAgent||navigator.vendor||window.opera);return check?"si":"no"}},{key:"_getGender",value:function _getGender(gender){if(gender=="F")return"femenino";else if(gender=="M")return"masculino";else return""}},{key:"_getSegmentGlobal",value:function _getSegmentGlobal(segment){if(segment=="S")return"004002";else if(segment=="P")return"004003";else return"004001"}},{key:"_getAge",value:function _getAge(bithDay){return(new Date).getFullYear()-new Date(bithDay).getFullYear()}},{key:"setProductPortfolio",value:function setProductPortfolio(data){var productPortfolio={productName:data.productName||"",balance:data.balance||"",currency:data.currency||"",productCode:data.productCode||""};this._digitalData.products.productPortfolio.push(productPortfolio)}},{key:"setProductsAttribute",value:function setProductsAttribute(data){var productsAttribute={primaryCategory:data.primaryCategory||"",productSubtype:data.productSubtype||"",productName:data.productName||"",productCode:data.productCode||"",quantity:data.quantity||"",amount:data.amount||"",paymentAmount:data.paymentAmount||"",numberOfPayments:data.numberOfPayments||"",paymentDate:data.paymentDate||"",paymentType:data.paymentType||"",serviceCharge:data.serviceCharge||"",currency:data.currency||"",numberOfHolders:data.numberOfHolders||"",interestRate:{tin:data.interestRate.tin||"",tae:data.interestRate.tae||"",rate:data.interestRate.rate||""},term:data.term||"",group:data.group||"",state:data.state||""};this._digitalData.products.attributes.push(productsAttribute)}},{key:"setInternalCampaignAttribute",value:function setInternalCampaignAttribute(data){var internalCampaignAttribute={location:data.location||"",campaignFormat:data.campaignFormat||"",collectiveCode:data.collectiveCode||"",campaignName:data.campaignName||"",product:data.product||"",productCode:data.productCode||"",quantity:data.quantity||""};this._digitalData.internalCampaign.attributes.push(internalCampaignAttribute)}},{key:"setOptimizationAttribute",value:function setOptimizationAttribute(data){var optimizationAttribute={idOptimization:data.idOptimization||"",experience:data.experience||"",place:data.place||"",type:data.type||"",executor:data.executor||"",audience:data.audience||""};this._digitalData.optimization.attributes.push(optimizationAttribute)}},{key:"setLevel",value:function setLevel(index,level){if(index>=1&&index<11){this._digitalData.page.pageInfo["level"+index]=level.toLowerCase()}}},{key:"setPageIntent",value:function setPageIntent(pageIntent){this._digitalData.page.pageInfo.pageIntent=pageIntent.toLowerCase()}},{key:"setLinkName",value:function setLinkName(linkName){this._digitalData.page.pageActivity.link.name=linkName}},{key:"setApplication",value:function setApplication(type,name){this._digitalData.application.application.type=type;this._digitalData.application.application.name=name}},{key:"setFulfillmentModel",value:function setFulfillmentModel(fulfillmentModel){this._digitalData.application.fulfillmentModel=fulfillmentModel}},{key:"setStep",value:function setStep(step){this._digitalData.application.step=step.toLowerCase()}},{key:"setApplicationState",value:function setApplicationState(state){this._digitalData.application.state=state}},{key:"setErrorPage",value:function setErrorPage(errorPage){this._digitalData.page.pageInfo.errorPage=errorPage}},{key:"setTypology",value:function setTypology(typology){this._digitalData.application.typology=typology}},{key:"setProgramTypeHired",value:function setProgramTypeHired(programTypeHired){this._digitalData.application.programTypeHired=programTypeHired}},{key:"setOffer",value:function setOffer(offer){this._digitalData.application.offer=offer}},{key:"setOperationNumber",value:function setOperationNumber(operationNumber){this._digitalData.application.operationNumber=operationNumber}},{key:"setProcess",value:function setProcess(process){this._digitalData.application.process=process}},{key:"setIsQualifiedVisits",value:function setIsQualifiedVisits(isQualifiedVisits){this._digitalData.application.isQualifiedVisits=isQualifiedVisits}},{key:"setGlobalApplication",value:function setGlobalApplication(globalApplication){this._digitalData.application.globalApplication=globalApplication.toLowerCase()}},{key:"setEarnings",value:function setEarnings(earnings){this._digitalData.application.earnings=earnings}},{key:"setErrorType",value:function setErrorType(errorType){this._digitalData.application.errorType=errorType}},{key:"setEventName",value:function setEventName(eventName){this._digitalData.internalCampaign.event.eventInfo.eventName=eventName}},{key:"setLoginType",value:function setLoginType(loginType){this._digitalData.page.pageActivity.loginType=loginType}},{key:"setCivilStatus",value:function setCivilStatus(civilStatus){this._digitalData.user.civilStatus=civilStatus}},{key:"setEducationLevel",value:function setEducationLevel(educationLevel){this._digitalData.user.educationLevel=educationLevel}},{key:"setJobType",value:function setJobType(jobType){this._digitalData.user.jobType=jobType}},{key:"setProspectID",value:function setProspectID(prospectID){this._digitalData.user.prospectID=prospectID}},{key:"setSegmentProfile",value:function setSegmentProfile(segmentProfile){this._digitalData.user.segment.profile=segmentProfile}},{key:"getDigitalData",value:function getDigitalData(){if(this._digitalData.internalCampaign.attributes.length>0){var firstInternalCampaign=this._digitalData.internalCampaign.attributes[0];this._digitalData.internalCampaign.event.eventInfo.siteActionName=Object.keys(firstInternalCampaign).map(function(e){return firstInternalCampaign[e]}).join(":")}var pageName=[this._digitalData.page.pageInfo.sysEnv,this._digitalData.page.pageInfo.area,this._digitalData.page.pageInfo.pageSegment];for(var i=1;i<11;i++){if(this._digitalData.page.pageInfo["level"+i]!=""){pageName.push(this._digitalData.page.pageInfo["level"+i])}}this._digitalData.page.pageInfo.pageName=pageName.join(":");digitalData=this._digitalData;return this._digitalData}}]);return DataLayer}();